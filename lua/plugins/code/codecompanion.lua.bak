return {
	{
		"olimorris/codecompanion.nvim",
		event = { "BufReadPre", "BufNewFile", "InsertEnter" },
		dependencies = {
			"nvim-lua/plenary.nvim",
			{ "nvim-treesitter/nvim-treesitter", build = ":TSUpdate" },
		},
		opts = {
			-- Use Copilot adapter by default
			strategies = {
				chat = { adapter = "copilot", mode = "GPT-5-mini" },
				inline = { adapter = "copilot" },
			},
			opts = {
				-- Set debug logging initially to help with token checks
				log_level = "DEBUG",
			},
		},
		config = function(_, opts)
			require("codecompanion").setup(opts)
			vim.keymap.set(
				"n",
				"<leader>cc",
				"<cmd>CodeCompanionActions<cr>",
				{ silent = true, noremap = true, desc = "Code Companion" }
			)
		end,
	},
}
